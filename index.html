<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Free Forms App</title>
  <link rel="manifest" href="manifest.json">
</head>
<body style="font-family: Arial, sans-serif; max-width: 720px; margin: 0 auto; padding: 16px;">
  <h2>Free Forms App</h2>

<label>Select Form</label><br/>
<select id="formName" style="width:100%;padding:10px;">
  <option value="Store Visit">Store Visit</option>
  <option value="Equipment Checklist">Equipment Checklist</option>
  <option value="Incident Report">Incident Report</option>
</select>

  <label>Your Name</label><br/>
  <input id="submittedBy" style="width:100%;padding:10px;" placeholder="Said"/><br/><br/>

  <label>Recipient Emails (comma separated)</label><br/>
  <input id="recipientEmails" style="width:100%;padding:10px;" placeholder="manager@..., ops@..."/><br/><br/>

  <hr/>

 <div id="storeVisitFields">
  <label>Site / Store</label><br/>
  <input id="site" style="width:100%;padding:10px;"><br/><br/>

  <label>Notes</label><br/>
  <textarea id="notes" style="width:100%;padding:10px;"></textarea><br/><br/>
</div>

<div id="incidentFields" style="display:none;">
  <label>Incident Description</label><br/>
  <textarea id="incidentDesc" style="width:100%;padding:10px;"></textarea><br/><br/>

  <label>Severity</label><br/>
  <select id="severity" style="width:100%;padding:10px;">
    <option>Low</option>
    <option>Medium</option>
    <option>High</option>
  </select><br/><br/>
</div>


  <label>Notes</label><br/>
  <textarea id="notes" style="width:100%;padding:10px;min-height:120px;" placeholder="What did you find?"></textarea><br/><br/>
  
  <label>Photo</label><br/>
<input type="file" id="photo" accept="image/*" capture="environment"><br/><br/>
 
  <button id="submitBtn" style="padding:12px 16px;">Submit & Email PDF</button>
  

  <p id="status" style="margin-top:12px;"></p>

  <script>
    const formSelect = document.getElementById("formName");

  formSelect.addEventListener("change", () => {
    document.getElementById("storeVisitFields").style.display =
      formSelect.value === "Store Visit" ? "block" : "none";

    document.getElementById("incidentFields").style.display =
      formSelect.value === "Incident Report" ? "block" : "none";
    // üî¥ PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL HERE:
    const ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbzXKW7vDflD4ibJSMq5Ur6g6J4W89wLgK9N3yeve-RZZQrAREoBJDajHntXs46PulRj/exec";

    document.getElementById("submitBtn").addEventListener("click", async () => {
      const status = document.getElementById("status");
      status.textContent = "Sending...";

      const payload = {
        formName: document.getElementById("formName").value,
        submittedBy: document.getElementById("submittedBy").value,
        recipientEmails: document.getElementById("recipientEmails").value,
        data: {
          Site: document.getElementById("site").value,
          Notes: document.getElementById("notes").value
        }
      };

      try {
        const res = await fetch(ENDPOINT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });
        const json = await res.json();

        if (json.ok) {
          status.innerHTML = `‚úÖ Sent. PDF: <a href="${json.pdfUrl}" target="_blank">Open PDF</a>`;
        } else {
          status.textContent = "‚ùå Error: " + json.error;
        }
      } catch (e) {
        status.textContent = "‚ùå Network error: " + e;
      }
    });

    // Register service worker (offline-ish)
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js");
    }
  </script>
</body>
</html>




